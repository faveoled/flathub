app-id: io.github.ardash.apple-flinger
runtime: org.freedesktop.Platform
runtime-version: '23.08'
sdk: org.freedesktop.Sdk
sdk-extensions:
  - org.freedesktop.Sdk.Extension.openjdk17
command: run.sh
rename-desktop-file: io.github.ardash.apple-flinger
finish-args:
  - --env=PATH=/app/jre/bin:/usr/bin:/app/bin
  - --socket=fallback-x11
  - --socket=wayland
  - --share=network
  - --share=ipc
  - --socket=pulseaudio
  - --device=dri

modules:
  - name: openjdk
    buildsystem: simple
    build-commands:
    - /usr/lib/sdk/openjdk17/install.sh

  - name: apple-flinger
    buildsystem: simple
    build-commands:
      - install -D apple-flinger.jar -t ${FLATPAK_DEST}/
      - install -Dm644 logo.png ${FLATPAK_DEST}/share/icons/hicolor/512x512/apps/${FLATPAK_ID}.png
      - install -Dm644 ${FLATPAK_ID}.desktop "${FLATPAK_DEST}/share/applications/${FLATPAK_ID}.desktop"
      - install -Dm755 run.sh /app/bin/run.sh
    sources:
    
      - type: file
        path: io.github.ardash.apple-flinger.desktop

      - type: file
        url: https://gitlab.com/ar-/apple-flinger/-/raw/master/art/logo/logo.png?ref_type=heads&inline=false
        dest-file: logo.png
        sha256: d6aada75efe24a11f481654253d6b3b217ae0b6eae7badc908139b718386527d


      - type: file
        url: https://github.com/faveoled/apple-flinger/releases/download/1.5.14/apple-flinger-1.5.14.jar
        dest-filename: apple-flinger.jar
        sha256: fb8b3bdbf13dd472576f278abd0af8858961ae59b9ce932b881ce85c7382e021

      - type: script
        commands:
          - java -jar /app/apple-flinger.jar "$@"
        dest-filename: run.sh
